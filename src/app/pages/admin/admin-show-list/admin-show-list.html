<div class="page">
  <div class="header">
    <h2>Admin – Tider</h2>
    <a class="btn primary" routerLink="/admin/shows/create">➕ Opret tid</a>
  </div>

  <div class="filter">
    <label>Filtrer på film:</label>
    <select [(ngModel)]="selectedMovieId" name="movieFilter">
      <option value="all">Alle</option>

      @if (films$ | async; as films) {
        @for (f of films; track f.id) {
          <option [value]="f.id">{{ f.titel }}</option>
        }
      }
    </select>
  </div>

  @if (shows$ | async; as shows) {
    @if (shows.length === 0) {
      <p>Ingen tider fundet.</p>
    } @else {
      <table class="table">
        <thead>
          <tr>
            <th>Film</th>
            <th>Tid</th>
            <th>Sal</th>
            <th>Pris</th>
            <th>Handling</th>
          </tr>
        </thead>

        <tbody>
          @for (s of shows; track s.id) {
            <tr>
              <td>{{ s.movieTitle }}</td>
              <td>{{ formatDate(s.startTime) }}</td>
              <td>{{ s.auditoriumName }}</td>
              <td>{{ s.price }} kr</td>
              <td class="actions">
                <a class="btn" [routerLink]="['/admin/shows/edit', s.id]">Rediger</a>
                <button class="btn danger" type="button" (click)="deleteShow(s.id)">Slet</button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    }
  }
</div>
